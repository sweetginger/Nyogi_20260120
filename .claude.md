# Nyogi 프로젝트 컨텍스트 및 작업 규칙

> 이 문서는 AI 어시스턴트가 프로젝트 맥락을 유지하고 일관된 작업을 수행하기 위한 가이드입니다.

---

## 1. 서비스 개요

### 서비스명
**Nyogi**

### 한 줄 설명
다국어 사용자가 대면 또는 온라인 미팅에서 실시간으로 서로의 언어를 이해하고, 미팅 종료 후에는 이중 언어 요약 미팅록을 공유할 수 있는 AI 통역·기록 서비스

### 핵심 가치
- 실시간 다국어 커뮤니케이션
- 화자 구분 기반 자동 미팅록
- 공유 가능한 AI 요약 기록

---

## 2. 타겟 사용자

| 사용자 유형 | 설명 |
|------------|------|
| 글로벌 협업 팀 | 스타트업/기업의 다국적 팀 |
| 세일즈/운영 담당자 | 외국인 고객·파트너와 미팅하는 담당자 |
| 기획자/PM | 해외 인터뷰, 리서치, 회의를 진행하는 담당자 |

---

## 3. 핵심 유저 플로우

```
회원가입 → 로그인 → 미팅 생성 → 미팅 타입 및 언어 설정 
→ (선택) 전문 용어 컨텍스트 등록 → 실시간 미팅 진행 
→ 미팅 종료 → 미팅록 확인 (이중 언어 + AI 요약) 
→ 링크 공유 / 팀 워크스페이스에서 열람
```

---

## 4. 미팅 생성 및 설정

### 4-1. 미팅 타입
| 타입 | 코드 | 설명 |
|------|------|------|
| 대면 미팅 | `in-person` | 오프라인, 기기 마이크 사용 |
| Zoom | `zoom` | Zoom 링크 연결, 봇 자동 참여 |
| Google Meet | `google-meet` | Meet 링크 연결, 봇 자동 참여 |

### 4-2. 언어 설정
- **화자 언어 A**: 기본값 한국어 (`ko`)
- **화자 언어 B**: 기본값 영어 (`en`)
- 시스템은 두 언어를 **동시에** 기록 및 번역

### 4-3. 전문 용어 컨텍스트
- 미팅 전 사용자가 전문 용어 리스트 입력 가능
- 예: 제품명, 기술 용어, 회사명
- 음성 인식 및 번역 정확도 보정에 활용

---

## 5. 실시간 미팅 처리 로직

### 5-1. 음성 인식 및 화자 구분
- 실시간 음성 스트리밍 입력
- Speaker Diarization (화자 분리)
- 화자별 텍스트 스크립트 생성

### 5-2. 대면 미팅
- 기기 마이크 입력 사용
- 동일 화면에서:
  - 화자 A 발화 → 언어 A + 언어 B 병기
  - 화자 B 발화 → 언어 B + 언어 A 병기
- 참가자는 모니터를 보며 실시간으로 상대 언어 확인

### 5-3. 온라인 미팅
- Zoom / Google Meet 링크 입력
- Nyogi 봇이 미팅에 자동 참여
- 봇이 음성을 수집하여 화자별로 기록

---

## 6. 미팅록 관리

### 6-1. 미팅 목록
- 내가 생성한 미팅 리스트 조회
- 팀 워크스페이스에서는 팀원이 생성한 미팅도 모두 조회 가능

### 6-2. 미팅 메타데이터 수정
- 미팅 제목 수정 가능
- 화자 이름 (화자 1, 화자 2) 수정 가능

---

## 7. AI 요약

### 요약 생성 시점
- 미팅 종료 후 자동 생성

### 요약 언어
- 설정했던 두 개 언어 모두로 요약 제공

### 요약 유형
| 유형 | 설명 |
|------|------|
| 핵심 논의 요약 | 미팅에서 논의된 주요 내용 |
| 결정 사항 | 미팅에서 결정된 사항들 |
| 액션 아이템 | 후속 조치 및 담당자 |

---

## 8. 미팅록 공유

### 공유 방식
- 미팅록은 **고유 링크**로 공유 가능

### 공유 권한 옵션
| 옵션 | 코드 | 설명 |
|------|------|------|
| 공개 | `public` | 링크가 있으면 누구나 접근 |
| 비공개 | `private` | 본인만 접근 |
| 화이트리스트 | `whitelist` | 지정 이메일만 접근 가능 |

---

## 9. 요금 및 결제

### 무료 플랜
- 회원가입 후 **1시간** 미팅 무료 제공
- 누적 미팅 시간이 1시간 초과 시 유료 결제 필요

### 프리미엄 플랜
- 결제 후 미팅 시간 **무제한**
- 월 ₩29,000

### 정책
- 개인 계정 + 팀 워크스페이스 모두 동일 정책 적용

---

## 10. 워크스페이스

### 기능
- 사용자가 워크스페이스 생성 가능
- 팀원 이메일 초대

### 워크스페이스 내 기능
- 팀원들이 생성한 모든 미팅록 열람
- 팀 단위 협업 및 기록 공유

---

## 11. 시스템 비기능 요구사항

| 항목 | 요구사항 |
|------|----------|
| 지연 최소화 | 실시간 음성 처리 지연 최소화 |
| 정확도 개선 | 언어별 정확도 개선을 위한 컨텍스트 반영 |
| 데이터 보안 | 미팅 데이터는 보안 저장 |
| 접근 제어 | 공유 권한에 따른 접근 제어 필수 |

---

## 12. 기술 스택

| 영역 | 기술 |
|------|------|
| Frontend | Next.js 15, React 19, TypeScript, Tailwind CSS |
| Backend | Next.js API Routes |
| Database | SQLite (Prisma ORM) |
| Auth | NextAuth.js |
| 음성 인식 | Web Speech API (추후 Whisper 등 확장) |
| 번역 | 외부 API 연동 예정 (Google Translate, DeepL 등) |
| AI 요약 | OpenAI API (추후 연동) |

---

## 13. 데이터베이스 스키마 요약

### 주요 모델
- `User` - 사용자 정보, 결제 상태, 미팅 시간
- `Workspace` - 워크스페이스 정보
- `WorkspaceMember` - 워크스페이스 멤버 관계
- `Meeting` - 미팅 정보, 설정, 상태
- `MeetingContext` - 전문 용어 컨텍스트
- `Speaker` - 화자 정보
- `Transcript` - 발화 기록 (원문 + 번역)
- `MeetingSummary` - AI 요약 (이중 언어)
- `MeetingShare` - 공유 화이트리스트

---

## 14. API 엔드포인트 목록

### 인증
- `POST /api/auth/signup` - 회원가입
- `GET/POST /api/auth/[...nextauth]` - NextAuth

### 미팅
- `GET/POST /api/meetings` - 목록 조회 / 생성
- `GET/PATCH/DELETE /api/meetings/[id]` - 상세 / 수정 / 삭제
- `POST /api/meetings/[id]/start` - 미팅 시작
- `POST /api/meetings/[id]/end` - 미팅 종료
- `POST /api/meetings/[id]/transcripts` - 트랜스크립트 추가
- `POST /api/meetings/[id]/summary` - AI 요약 생성
- `GET/PATCH/POST/DELETE /api/meetings/[id]/share` - 공유 관리

### 워크스페이스
- `GET/POST /api/workspaces` - 목록 조회 / 생성
- `GET/PATCH/DELETE /api/workspaces/[id]` - 상세 / 수정 / 삭제
- `POST/DELETE /api/workspaces/[id]/members` - 멤버 관리

### 사용자
- `GET /api/user` - 현재 사용자 정보
- `POST /api/user/upgrade` - 프리미엄 업그레이드

---

## 15. 작업 규칙

### 코드 스타일
- TypeScript 사용 필수
- 컴포넌트는 함수형 컴포넌트 사용
- 클라이언트 컴포넌트는 `'use client'` 명시
- Tailwind CSS 클래스 사용

### 파일 구조
```
src/
├── app/              # Next.js App Router 페이지 및 API
├── components/       # 재사용 컴포넌트
│   ├── layout/       # 레이아웃 관련
│   ├── providers/    # Context Provider
│   └── ui/           # 기본 UI 컴포넌트
├── lib/              # 유틸리티 및 설정
└── types/            # TypeScript 타입 정의
```

### 네이밍 컨벤션
- 컴포넌트: PascalCase (`Button.tsx`)
- 유틸리티: camelCase (`formatDate.ts`)
- API 라우트: kebab-case (폴더명)
- 타입/인터페이스: PascalCase

### API 응답 형식
```typescript
// 성공
{ data: T }
// 또는
{ meeting: Meeting }
{ meetings: Meeting[] }

// 실패
{ error: string }
```

### 에러 처리
- API에서 적절한 HTTP 상태 코드 반환
- 401: 인증 필요
- 403: 권한 없음
- 404: 리소스 없음
- 400: 잘못된 요청
- 500: 서버 오류

### 보안
- 모든 API에서 세션 검증 필수
- 리소스 접근 시 권한 확인
- 민감 데이터 노출 금지

---

## 16. 구현 완료 기능

### 대면 미팅 ✅
> 상세 문서: `docs/in-person-meeting.md`

- [x] 실시간 음성 인식 (Web Speech API)
- [x] 화자 구분 및 전환
- [x] 실시간 번역 (OpenAI GPT-4o-mini)
- [x] 이중 언어 자막 표시 (리스트/분할 뷰)
- [x] 마이크 권한 관리
- [x] 음성 인식 자동 재시작 (안정성)
- [x] 미팅 기록 저장 (원문 + 번역)
- [x] 시간 표시 (UTC 저장, 로컬 표시)

### 인증 ✅
- [x] 이메일/비밀번호 회원가입
- [x] 이메일/비밀번호 로그인
- [x] Google OAuth 로그인

---

## 17. 향후 구현 예정 기능

- [ ] 온라인 미팅 (Zoom/Google Meet 봇 자동 참여)
- [ ] 실제 AI 요약 API 연동 (OpenAI)
- [ ] 실시간 WebSocket 통신
- [ ] 결제 시스템 연동 (Stripe, Toss)
- [ ] 이메일 알림 시스템
- [ ] 모바일 앱 (React Native)

---

## 18. 환경 변수

```env
# Database
DATABASE_URL="file:./dev.db"

# NextAuth
NEXTAUTH_URL="http://localhost:3001"
NEXTAUTH_SECRET="your-secret-key"

# Google OAuth (선택)
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# 번역 API (대면 미팅 필수)
OPENAI_API_KEY="sk-..."
```

---

## 19. 관련 문서

| 문서 | 경로 | 설명 |
|------|------|------|
| 대면 미팅 | `docs/in-person-meeting.md` | 대면 미팅 기능 상세 명세 |

---

> **Note**: 이 문서는 프로젝트 진행에 따라 업데이트됩니다.
> 마지막 업데이트: 2026-01-25

